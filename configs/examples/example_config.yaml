universe:
  symbols:
    - EURUSD
    - GBPUSD
    - USDJPY
  timeframe: M15
bar_contract:
  signal_on: close
  fill_on: open_next
  allow_bar0: false
regime:
  atr_pct_window: 960
  atr_pct_n: 14
  z_low: -0.5
  z_high: 0.5
  spike_tr_atr_th: 2.5
strategies:
  enabled:
    - S1_TREND_BREAKOUT_DONCHIAN
  params:
    S1_TREND_EMA_ATR_ADX:
      ema_fast: 20
      ema_slow: 50
      adx_period: 14
      adx_th: 25
      atr_period: 14
      k_sl: 2.5
      min_sl_points: 8.0
      k_tp: 1.5
      min_tp_points: 8.0
    S2_MR_ZSCORE_EMA_REGIME:
      zscore_window: 30
      ema_regime: 200
      k_sl: 2.0
      min_sl_points: 5.0
    S3_BREAKOUT_ATR_REGIME_EMA200:
      breakout_lookback: 55
      atr_period: 14
      k_sl: 2.0
      min_sl_points: 5.0
    S1_TREND_BREAKOUT_DONCHIAN:
      # Trend regime
      ema_fast: 30
      ema_slow: 100
      adx_period: 14
      adx_th: 25
      adx_rising: false

      # Breakout timing
      breakout_lookback: 55
      buffer_atr: 0.1          # buffer = 0.1 * ATR(price)
      allowed_vol_regimes: ["MID", "HIGH"]
      spike_block: false       # true solo dopo

      # Anti-overtrading
      cooldown_bars: 8         # 2 ore su M15

      # Risk / exits
      atr_period: 14
      k_sl: 2.5
      k_tp: 1.5
      min_sl_points: 8.0
      min_tp_points: 5.0
risk:
  max_hold_bars: 96
  r_base: 0.002
  caps:
    per_strategy: 0.03
    per_symbol: 0.05
    usd_exposure_cap: 100000
  conflict_policy: priority
  priority_order:
    - S1_TREND_EMA_ATR_ADX
  dd_day_limit: 0.02
  dd_week_limit: 0.05
  max_execution_errors: 3
costs:
  spread_baseline_pips:
    EURUSD: 0.7
    GBPUSD: 0.9
    USDJPY: 0.8
  slippage:
    slip_base: 0.1
    slip_k: 0.5
    spike_tr_atr_th: 1.5
    spike_mult: 2.0
  scenarios:
    A: 1.0
    B: 1.5
    C: 2.0
validation:
  walk_forward:
    train: 252
    val: 63
    test: 63
  perturb_core_params_pct: 0.1
montecarlo:
  mc1:
    block_min: 5
    block_max: 20
    n_sims: 500
  mc2:
    spread_noise_range: [0.8, 1.2]
    slippage_noise_range: [0.9, 1.3]
    n_sims: 300
outputs:
  runs_dir: ./runs
  write_trades_csv: true
  write_report_json: true
  write_mc_json: true
  debug: true
reproducibility:
  random_seed: 42
